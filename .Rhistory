df <- data.frame( 
    person = c('Sam','Sam','Sam','Greg','Tom','Tom','Tom','Mary','Mary'), 
    group = c('a','b','c','a','b','c','d','b','d'), 
    stringsAsFactors = F)
m <- table( df )
M <- as.matrix( m )
library('Matrix')
A <- spMatrix(nrow=length(unique(df$person)),
ncol=length(unique(df$group)),
i = as.numeric(factor(df$person)),
j = as.numeric(factor(df$group)),
x = rep(1, length(as.numeric(df$person))) )
row.names(A) <- levels(factor(df$person))
colnames(A) <- levels(factor(df$group))
A
Acol <- t(A) %*% A
Acol <- tcrossprod(t(A))
Acol
class(Acol)
library(tidyverse)
dd <- as.tibble(Acol)
dd <- as_tibble(Acol)
Acol
dd <- as.data.frame(Acol)
dd <- as.data.frame(as.matrix(Acol))
dd
dd <- as_tibble(as.matrix(Acol))
dd
dd <- as.data.frame(as.matrix(Acol))
row.names(dd)
colnames(dd)
dd %>% rownames_to_column()
dd %>% rownames_to_column() %>% pivot_longer(-rowname,names_to="colname",values_to="count" )
dd %>% rownames_to_column() %>% pivot_longer(-rowname,names_to="colname",values_to="count" ) %>% filter(count>0)
q()
colnames(dd)
order(colnames(dd))
dd_l <- dd %>% rownames_to_column() %>% pivot_longer(-rowname, names_to="colname", values_to="count")
library(tidyverse)
dd_l <- dd %>% rownames_to_column() %>% pivot_longer(-rowname, names_to="colname", values_to="count")
dd_l
unique(dd_l$colname)
unique(dd_l$rowname)
dd_l$colname <- factor(dd_l$colname, level=unique(dd_l$colname))
dd_l$colname
q()
m2 <- matrix(1:20, 4, 5)
m2
lower.tri(m2)
m2[lower.tri(m2)] <- NA
m2[lower.tri(m2)]
m2
q()
ls()
m2 <- matrix(1:20, 4, 5)
m2
class(m2)
lower.tri(m2)
m2[lower.tri(m2)] <- NA
m2
m2[lower.tri(m2)] <- 0
m2
ls()
Acol
class(Acol)
lower.tri(Acol)
Acol[lower.tri(Acol)] <- 0
Acol
library(tidyverse)
keywords_heatmap_long <- read_delim("keywords_heatmap.txt",delim="\t", col_names=T)
head(keywords_heatmap_long)
dd <- keywords_heatmap_long %>% mutate(count=if_else(colname==rowname,-1,count))
head(dd)
tail(dd)
na_omit()
na.omit()
library(Matrix)
sessionInfo()
q()
